<html>
  <head>
    <title>Labs 271 - Robot Arms</title>
    <style>
      .actions {
        display: flex;
        align-items: left;
        padding-bottom: 15px;
      }

      .actions button {
        margin-right: 15px;
      }

      #terminal {
        width: 100%;
        height: 80%;
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        font-size: 14px;
        line-height: 18px;
        padding: 8px;
      }
    </style>
  </head>
  <body>
    <h1>Status: <span id="status-text">Loading....</span></h1>
    <div class="actions">
      <button id="start-button">Start</button>
      <button id="stop-button">Stop</button>
    </div>

    <textarea id="terminal" readonly>> Webserver started</textarea>


    <script>
      const startButton = document.getElementById("start-button");
      const stopButton = document.getElementById("stop-button");
      const terminal = document.getElementById("terminal");
      const statusText = document.getElementById('status-text');

      function printCommand(command) {
        terminal.textContent = terminal.textContent + `\n> ${command}`
      }

      function makeRequest(action) {
        return fetch(`http://localhost:3000/${action}`, { method: 'GET' });
      }

      function updateStatus(status) {
        statusText.textContent = status;
      }

      startButton.addEventListener("click", () => {
        printCommand('Requested to start sorting process');
        makeRequest('start')
      });

      stopButton.addEventListener("click", () => {
        printCommand('Requested to stop sorting process');
        makeRequest('stop');
      });


      window.setInterval(() => {
        makeRequest('status').then((response) => {
          return response.json();
        })
        .then((response) => {
          updateStatus(response.status);
        })
      }, 1000);

    </script>
  </body>
</html>
